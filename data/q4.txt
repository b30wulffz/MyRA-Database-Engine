LOAD EMPLOYEE
LOAD WORKS_ON
PROJ_EMP <- CROSS EMPLOYEE WORKS_ON
EMP_IN_PROJ <- SELECT Ssn == Essn FROM PROJ_EMP
EMP_EMP_PROJ <- CROSS EMP_IN_PROJ EMP_IN_PROJ
EMP_SUP_PROJ <- SELECT EMP_IN_PROJ1_Super_ssn == EMP_IN_PROJ2_Ssn FROM EMP_EMP_PROJ
EMP_SUP_SAME_PROJ <- SELECT EMP_IN_PROJ1_Pno == EMP_IN_PROJ2_Pno FROM EMP_SUP_PROJ
ALMOST_ANS <- PROJECT EMP_IN_PROJ1_Ssn,EMP_IN_PROJ2_Ssn,EMP_IN_PROJ1_Pno FROM EMP_SUP_SAME_PROJ
RENAME EMP_IN_PROJ1_Ssn TO Ssn FROM ALMOST_ANS
RENAME EMP_IN_PROJ2_Ssn TO Super_ssn FROM ALMOST_ANS
RENAME EMP_IN_PROJ1_Pno TO Pno FROM ALMOST_ANS
Q4 <- PROJECT Ssn,Super_ssn,Pno FROM ALMOST_ANS
EXPORT Q4
